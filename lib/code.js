/*! Aqua v19.11.3 by @ignatiusmb - imbagus.com
 *  Copyright (c) 2019 Ignatius Bagus
 *  MIT Licensed -> github.com/ignatiusmb/aqua
 *  https://aqua.imbagus.com
 */
import STATIC from"./helper/static";import is from"./helper/is";const syntaxHighlighter=(e=!1)=>{if(is.highlighter.added||is.highlighter.loaded)return;is.highlighter.added=!0;const t="https://cdn.imbagus.com/ajax/prism.js";if(e)return t;const a=document.createElement("script");return a.type="text/javascript",a.src=t,a.dataset.manual=!0,document.body.appendChild(a)},highlight=()=>{if(!is.highlighter.running)if(is.highlighter.loaded)Prism.highlightAll();else{syntaxHighlighter().onload=()=>is.highlighter.loaded=!0,is.highlighter.running=!0;const e=setTimeout(()=>{is.highlighter.loaded?(Prism.highlightAll(),is.highlighter.running=!1,clearTimeout(e)):setTimeout(e,STATIC.checkTimeout)},STATIC.checkTimeout)}},createToolbar=e=>{const t=document.createElement("div");t.className="aqua-code-toolbar";const a=(e,t)=>{const a=document.createElement("a"),o=document.createElement("i"),i=document.createElement("span");return a.className="aqua-ctb-item",o.className=e,i.className="aqua-ctb-tooltip",i.innerText=t,a.appendChild(o),a.appendChild(i),a},o=document.querySelector(".aqua-snackbar.code"),i=a("fas fa-list-ol","Toggle Numbering");i.addEventListener("click",()=>e.classList.toggle("numbered")),t.appendChild(i);const s=a("far fa-copy","Copy"),n={};return s.addEventListener("click",()=>{const t=e.querySelectorAll("code"),a=document.createElement("textarea"),i=document.createElement("span");a.className="ghost-area";for(const e of t)a.value+=e.innerText;document.body.appendChild(a),a.focus(),a.select();try{document.execCommand("copy")?i.textContent="Copied to clipboard!":i.textContent="Copy failed"}catch(e){i.textContent=`An error occurred --\x3e ${e}`}"I"!==o.firstChild.tagName&&o.removeChild(o.firstChild),o.insertAdjacentElement("afterbegin",i),o.classList.contains("show")?(n.add&&clearTimeout(n.add),n.remove&&clearTimeout(n.remove),o.classList.remove("show"),n.add=setTimeout(()=>o.classList.add("show"),600),n.remove=setTimeout(()=>o.classList.remove("show"),5e3)):(n.add&&clearTimeout(n.add),n.remove&&clearTimeout(n.remove),n.add=setTimeout(()=>o.classList.add("show"),200),n.remove=setTimeout(()=>o.classList.remove("show"),5e3)),document.body.removeChild(a)}),t.appendChild(s),t},init=()=>{if(!document.querySelectorAll("div.aqua-code-toolbar").length){if(!document.querySelector(".aqua-snackbar.code")){const e=document.createElement("div");e.className="aqua-snackbar code";const t=document.createElement("i");t.className="fas fa-times",t.addEventListener("click",()=>e.classList.remove("show")),e.appendChild(t),document.body.appendChild(e)}for(const e of document.querySelectorAll("pre.aqua-code")){const t=e.dataset.language,a=e.dataset.title;let o=parseInt(e.dataset.lineStart);const i=document.createElement("div"),s=document.createElement("div"),n=document.createElement("pre");i.classList.add("aqua-code-box"),s.classList.add("aqua-code-header"),s.dataset.language=t||"",n.className=e.className,a?s.textContent=a:s.classList.add("empty"),t?n.classList.add(`language-${t}`):n.classList.add("language-none"),o||(o=1);for(const t of e.textContent.split("\n")){const e=document.createElement("code");e.dataset.line=o++,e.textContent=`${t}\n`,n.appendChild(e)}for(;!n.firstChild.textContent.trim().length;)n.removeChild(n.firstChild);for(;!n.lastChild.textContent.trim().length;)n.removeChild(n.lastChild);s.appendChild(Aqua.code.createToolbar(n)),i.appendChild(s),i.appendChild(n),e.replaceWith(i)}}};export{syntaxHighlighter,highlight,createToolbar,init};